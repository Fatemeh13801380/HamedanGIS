from flask import Flask, render_template
import folium

app = Flask(__name__)

# داده‌های مکان‌های گردشگری (اینجا ۳ نمونه، تو ۱۵ تا وارد کن)
locations = [
    {"name": "گنبد علویان", "lat": 34.7992, "lon": 48.4736, "history": "بنایی از دوره سلجوقی (قرن ۱۲) با معماری خیره‌کننده.", "address": "همدان، خیابان علویان، نزدیک امامزاده عبدالله"},
    {"name": "آرامگاه بوعلی سینا", "lat": 34.7975, "lon": 48.4778, "history": "آرامگاه فیلسوف و پزشک برجسته ایرانی، ساخته‌شده در ۱۳۳۰ شمسی.", "address": "همدان، میدان بوعلی سینا"},
    {"name": "تپه هگمتانه", "lat": 34.7984, "lon": 48.4861, "history": "پایتخت مادها و یکی از قدیمی‌ترین محوطه‌های باستانی ایران.", "address": "همدان، خیابان اکباتان"},
    {"name": "آرامگاه باباطاهر", "lat": 34.8067, "lon": 48.4708, "history": "آرامگاه شاعر و عارف قرن ۴ و ۵ هجری، ساخته‌شده در ۱۳۴۴ شمسی.", "address": "همدان، میدان باباطاهر"},
    {"name": "غار علی‌صدر", "lat": 35.3058, "lon": 48.2203, "history": "بزرگ‌ترین غار آبی جهان از دوره ژوراسیک.", "address": "روستای علی‌صدر، کبودرآهنگ"},
    {"name": "گنج‌نامه", "lat": 34.7611, "lon": 48.4386, "history": "کتیبه‌های هخامنشی از داریوش و خشایارشا.", "address": "۵ کیلومتری غرب همدان، دره عباس‌آباد"},
    {"name": "آبشار گنج‌نامه", "lat": 34.7615, "lon": 48.4380, "history": "آبشاری طبیعی در دامنه کوه الوند، مقصد طبیعت‌گردی.", "address": "نزدیکی کتیبه‌های گنج‌نامه"},
    {"name": "آرامگاه استر و مردخای", "lat": 34.7960, "lon": 48.4750, "history": "زیارتگاه یهودیان از قرن ۱۱ میلادی.", "address": "همدان، خیابان شریعتی"},
    {"name": "مسجد جامع همدان", "lat": 34.7970, "lon": 48.4800, "history": "مسجدی از دوره قاجار با معماری سنتی.", "address": "همدان، خیابان اکباتان"},
    {"name": "بازار سنتی همدان", "lat": 34.7980, "lon": 48.4785, "history": "بازاری از دوره قاجار، مرکز تجارت و صنایع دستی.", "address": "همدان، خیابان‌های باباطاهر و اکباتان"},
    {"name": "شیر سنگی", "lat": 34.7925, "lon": 48.4830, "history": "مجسمه‌ای از دوره مادها یا اشکانیان.", "address": "همدان، میدان شیر سنگی"},
    {"name": "روستای ورکانه", "lat": 34.6733, "lon": 48.5711, "history": "روستای سنگی ۴۰۰ ساله، معروف به رنسانس ایران.", "address": "۲۰ کیلومتری جنوب‌شرق همدان"},
    {"name": "موزه تاریخ طبیعی همدان", "lat": 34.7950, "lon": 48.4760, "history": "موزه‌ای با مجموعه حیوانات تاکسیدرمی‌شده.", "address": "همدان، میدان بوعلی سینا"},
    {"name": "حمام قلعه (موزه مردم‌شناسی)", "lat": 34.7965, "lon": 48.4790, "history": "حمامی از دوره قاجار، تبدیل‌شده به موزه.", "address": "همدان، خیابان شریعتی"},
    {"name": "چشمه گیان", "lat": 34.1622, "lon": 48.2333, "history": "چشمه‌ای طبیعی با درختان کهنسال.", "address": "۳۰ کیلومتری جنوب نهاوند"}
]

@app.route('/')
def map():
    # ایجاد نقشه با مرکزیت همدان
    hamedan_map = folium.Map(location=[34.7978, 48.4778], zoom_start=13, tiles='OpenStreetMap')

    # اضافه کردن مارکرها
    for loc in locations:
        popup_content = f"""
        <b>{loc['name']}</b><br>
        <b>پیشینه:</b> {loc['history']}<br>
        <b>آدرس:</b> {loc['address']}
        """
        folium.Marker(
            location=[loc['lat'], loc['lon']],
            popup=folium.Popup(popup_content, max_width=300),
            tooltip=loc['name']
        ).add_to(hamedan_map)

    # ذخیره نقشه به عنوان HTML
    map_html = hamedan_map._repr_html_()
    return render_template('map.html', map_html=map_html)

if __name__ == '__main__':
    app.run(debug=True)